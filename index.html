<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8" />
    <title>✨ magiaa ✨</title>
    <style>
        body {
            background: #222;
            color: #eee;
            font-family: 'Courier New', monospace;
            padding: 128px;
            overflow-x: hidden;
        }

        h1 {
            text-align: center;
            color: #ffcc00;
        }

        .controls {
            text-align: center;
            margin-bottom: 20px;
        }

        .decimal-display {
            background: #333;
            color: #0f0;
            font-size: 2em;
            padding: 10px;
            border: 4px inset #555;
            width: 300px;
            margin: 0 auto;
            text-align: center;
            font-family: 'Digital-7 Mono', monospace;
        }

        .decimal-display:focus {
            outline: none;
            background: #222;
        }

        .board {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-top: 64px;
            position: relative;
        }

        .switches {
            display: flex;
            margin-top: 54px;
            flex-direction: column;
            gap: 6px;
            margin-right: 40px;
            position: relative;

        }

        .sw-label {
            display: flex;
            align-items: center;
            gap: 8px;
            color: #ccc;
        }

        .switch {
            appearance: none;
            width: 40px;
            height: 20px;
            background: #444;
            border-radius: 10px;
            position: relative;
            cursor: pointer;
            outline: none;
            transition: background 0.2s;
        }

        .switch:checked {
            background: #0a0;
        }

        .switch::before {
            content: '';
            position: absolute;
            top: 2px;
            left: 2px;
            width: 16px;
            height: 16px;
            background: #eee;
            border-radius: 50%;
            transition: transform 0.2s;
        }

        .switch:checked::before {
            transform: translateX(20px);
        }

        .rom {
            margin-top: 64px;
            position: relative;
            width: 180px;
            height: 900px;
            background: #444;
            border: 4px solid #666;
            border-radius: 10px;
            margin-right: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .rom::before {
            content: 'ROM 27x1';
            position: absolute;
            top: -30px;
            left: 50%;
            transform: translateX(-50%);
            background: #222;
            padding: 4px 8px;
            color: #ffcc00;
            font-weight: bold;
        }

        .pins-in {
            margin-top: 11px;
            position: absolute;
            left: -10px;
            top: 10px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            height: 850px;
        }

        .pin {
            width: 6px;
            height: 14px;
            background: #888;
        }

        .pin-out {
            position: absolute;
            right: -10px;
            top: 50%;
            width: 6px;
            height: 20px;
            background: #f90;
            transform: translateY(-50%);
        }


        .led {
            margin-top: 64px;
            margin-left: 64px;
            width: 128px;
            height: 128px;
            background: radial-gradient(circle at 30% 30%, #f00 10%, #600);
            border: 4px solid #a00;
            border-radius: 50%;
            box-shadow: 0 0 5px #400;
            opacity: 0.6;
        }

        .led.on {
            background: radial-gradient(circle at 30% 30%, #f77 80%, #600);
            box-shadow: 0 0 20px #f00;
        }
    </style>
</head>

<body>
    <h1>✨ tu circuito de confi ✨</h1>

    <div class="controls">
        <input type="text" id="decimalDisplay" class="decimal-display" value="0" />
    </div>

    <div class="board">
        <div class="switches" id="switches"></div>
        <div class="rom" id="rom">
            <div class="pins-in" id="pinsIn"></div>
            <div class="pin-out" id="pinOut"></div>
        </div>
        <div class="led" id="led"></div>
    </div>
    <script src="rom27.js"></script>
    <script>
        const NUM = 27;
        const switchesDiv = document.getElementById('switches');
        const decimalDisplay = document.getElementById('decimalDisplay');
        const rom = document.getElementById('rom');
        const pinsIn = document.getElementById('pinsIn');
        const pinOut = document.getElementById('pinOut');
        const led = document.getElementById('led');
        const inputs = [];

        // Definimos aquí el conjunto de direcciones activas

        // Crear interruptores y etiquetas
        for (let i = 0; i < NUM; i++) {
            const label = document.createElement('label');
            label.className = 'sw-label';
            const sw = document.createElement('input');
            sw.type = 'checkbox';
            sw.className = 'switch';
            sw.dataset.index = i;
            sw.addEventListener('change', onInputChange);
            label.appendChild(sw);
            label.appendChild(document.createTextNode('D' + (NUM - 1 - i)));
            switchesDiv.appendChild(label);
            inputs.push(sw);
        }

        // Crear pines de entrada
        for (let i = 0; i < NUM; i++) {
            const pin = document.createElement('div');
            pin.className = 'pin';
            pinsIn.appendChild(pin);
        }



        function updateFromValue(val) {
            val = Math.max(0, Math.min((1 << NUM) - 1, val));
            decimalDisplay.value = val;
            for (let i = 0; i < NUM; i++) {
                const bit = (val >> (NUM - 1 - i)) & 1;
                inputs[i].checked = !!bit;
            }
            updateLED();
        }

        function onInputChange() {
            let val = 0;
            inputs.forEach((sw, i) => {
                if (sw.checked) val |= (1 << (NUM - 1 - i));
            });
            updateFromValue(val);
        }

        function updateLED() {
            const val = parseInt(decimalDisplay.value) || 0;
            const on = activeAddresses.has(val);
            led.classList.toggle('on', on);
        }

        decimalDisplay.addEventListener('input', () => {
            const val = parseInt(decimalDisplay.value) || 0;
            updateFromValue(val);
        });

        updateFromValue(0);
    </script>
</body>

</html>